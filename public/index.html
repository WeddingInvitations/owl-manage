<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="theme-color" content="#151824" />
    <title>OwlManage</title>
    <link rel="stylesheet" href="css/styles.css?v=20250219f" />
  </head>
  <body class="dark">
    <header class="app-header">
      <div>
        <h1>OwlManage</h1>
        <p class="muted">MVP interno ¬∑ Contabilidad ¬∑ Fichajes ¬∑ Entrenamientos ¬∑ Pagos</p>
      </div>
      <div class="auth-status">
        <span id="userBadge" class="badge">Invitado</span>
        <button id="logoutBtn" class="btn ghost" disabled>Cerrar sesi√≥n</button>
      </div>
    </header>

    <section id="mainShell" class="main-shell hidden">
      <nav class="side-menu">
        <h2>Men√∫</h2>
        <button class="menu-btn active" data-view="summaryView">Resumen</button>
        <button class="menu-btn" data-view="paymentsView">Ingresos</button>
        <button class="menu-btn" data-view="expensesView">Gastos</button>
        <button class="menu-btn" data-view="checkinsView">Fichajes</button>
        <button class="menu-btn" data-view="trainingsView">Entrenamientos</button>
        <button class="menu-btn" data-view="athletesView">Atletas</button>
        <button class="menu-btn" data-view="acroView">Atletas Acrobacias</button>
        <button class="menu-btn" data-view="rolesView">Roles</button>
      </nav>
      <section class="content">
        <section id="summaryView" class="view">
          <div class="card">
            <h2>Resumen</h2>
            <div class="summary">
              <div>
                <p class="label">Ingresos</p>
                <p id="summaryIncome" class="value">0 ‚Ç¨</p>
              </div>
              <div>
                <p class="label">Gastos</p>
                <p id="summaryExpenses" class="value">0 ‚Ç¨</p>
              </div>
              <div>
                <p class="label">Beneficio</p>
                <p id="summaryProfit" class="value">0 ‚Ç¨</p>
              </div>
            </div>
            <button id="refreshSummary" class="btn ghost">Actualizar</button>
          </div>
          <div class="card">
            <div class="detail-header">
              <h3>Balance anual</h3>
              <select id="monthlyYearSelect"></select>
            </div>
            <div class="table-container">
              <table class="table summary-table-mobile">
                <thead>
                  <tr>
                    <th>Mes</th>
                    <th>Ingresos</th>
                    <th>Gastos</th>
                    <th>Balance</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="monthlySummaryBody"></tbody>
              </table>
            </div>
          </div>
          <div id="monthlyDetailCard" class="card hidden">
            <div class="detail-header">
              <h3 id="monthlyDetailTitle">Detalle mensual</h3>
              <button id="monthlyDetailClose" class="btn ghost" type="button">
                Cerrar
              </button>
            </div>
            <div class="detail-grid">
              <div>
                <h4>Ingresos</h4>
                <table class="table">
                  <thead>
                    <tr>
                      <th>Fecha</th>
                      <th>Concepto</th>
                      <th>Importe</th>
                    </tr>
                  </thead>
                  <tbody id="monthlyIncomeBody"></tbody>
                </table>
              </div>
              <div>
                <h4>Gastos</h4>
                <table class="table">
                  <thead>
                    <tr>
                      <th>Fecha</th>
                      <th>Concepto</th>
                      <th>Importe</th>
                    </tr>
                  </thead>
                  <tbody id="monthlyExpenseBody"></tbody>
                </table>
              </div>
            </div>
            <p id="monthlyDetailBalance" class="muted"></p>
          </div>
        </section>

        <section id="paymentsView" class="view hidden">
          <div class="card">
            <div class="detail-header">
              <h2>Contabilidad ¬∑ Ingresos</h2>
              <div class="filter-row">
                <select id="paymentMonthSelect"></select>
                <button id="paymentCsvOpen" class="btn ghost small" type="button" title="Importar CSV">üìÑ CSV</button>
                <button id="paymentTemplateDownload" class="btn ghost small" type="button" title="Descargar plantilla">‚¨á Plantilla</button>
              </div>
            </div>
            <form id="paymentForm" class="stack">
              <label>
                Concepto
                <input id="paymentConcept" type="text" required />
              </label>
              <label>
                Fecha
                <input id="paymentDate" type="date" required />
              </label>
              <label>
                Importe (‚Ç¨)
                <input id="paymentAmount" type="number" min="0" step="0.01" required />
              </label>
              <button class="btn" type="submit">Registrar ingreso</button>
            </form>
            <ul id="paymentList" class="list"></ul>
          </div>
          <div id="paymentCsvModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Importar ingresos desde CSV</h3>
                <button id="paymentCsvClose" class="btn ghost small" type="button">Cerrar</button>
              </div>
              <form id="paymentCsvForm" class="stack">
                <p class="muted">El CSV debe tener 3 columnas: Concepto, Fecha (YYYY-MM-DD), Importe. La primera fila (cabecera) se ignorar√°.</p>
                <label>
                  Archivo CSV
                  <input id="paymentCsvFile" type="file" accept=".csv,text/csv" required />
                </label>
                <button class="btn" type="submit">Importar</button>
                <p id="paymentCsvStatus" class="muted"></p>
              </form>
            </div>
          </div>
          <div id="paymentEditModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Editar ingreso</h3>
                <button id="paymentEditClose" class="btn ghost small" type="button">Cerrar</button>
              </div>
              <form id="paymentEditForm" class="stack">
                <input id="paymentEditId" type="hidden" />
                <label>
                  Concepto
                  <input id="paymentEditConcept" type="text" required />
                </label>
                <label>
                  Fecha
                  <input id="paymentEditDate" type="date" required />
                </label>
                <label>
                  Importe (‚Ç¨)
                  <input id="paymentEditAmount" type="number" min="0" step="0.01" required />
                </label>
                <button class="btn" type="submit">Guardar cambios</button>
              </form>
            </div>
          </div>
          <div id="paymentDeleteModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Eliminar ingreso</h3>
              </div>
              <p>¬øEst√°s seguro de que quieres eliminar este ingreso?</p>
              <p id="paymentDeleteInfo" class="muted"></p>
              <input id="paymentDeleteId" type="hidden" />
              <div class="btn-group">
                <button id="paymentDeleteConfirm" class="btn danger" type="button">Eliminar</button>
                <button id="paymentDeleteCancel" class="btn ghost" type="button">Cancelar</button>
              </div>
            </div>
          </div>
        </section>

        <section id="expensesView" class="view hidden">
          <div class="card">
            <div class="detail-header">
              <h2>Contabilidad ¬∑ Gastos</h2>
              <div class="filter-row">
                <select id="expenseMonthSelect"></select>
                <button id="expenseCsvOpen" class="btn ghost small" type="button" title="Importar CSV">üìÑ CSV</button>
                <button id="expenseTemplateDownload" class="btn ghost small" type="button" title="Descargar plantilla">‚¨á Plantilla</button>
              </div>
            </div>
            <form id="expenseForm" class="stack">
              <label>
                Concepto
                <input id="expenseConcept" type="text" required />
              </label>
              <label>
                Fecha
                <input id="expenseDate" type="date" required />
              </label>
              <label>
                Importe (‚Ç¨)
                <input id="expenseAmount" type="number" min="0" step="0.01" required />
              </label>
              <button class="btn" type="submit">Registrar gasto</button>
            </form>
            <ul id="expenseList" class="list"></ul>
          </div>
          <div id="expenseCsvModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Importar gastos desde CSV</h3>
                <button id="expenseCsvClose" class="btn ghost small" type="button">Cerrar</button>
              </div>
              <form id="expenseCsvForm" class="stack">
                <p class="muted">El CSV debe tener 3 columnas: Concepto, Fecha (YYYY-MM-DD), Importe. La primera fila (cabecera) se ignorar√°.</p>
                <label>
                  Archivo CSV
                  <input id="expenseCsvFile" type="file" accept=".csv,text/csv" required />
                </label>
                <button class="btn" type="submit">Importar</button>
                <p id="expenseCsvStatus" class="muted"></p>
              </form>
            </div>
          </div>
          <div id="expenseEditModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Editar gasto</h3>
                <button id="expenseEditClose" class="btn ghost small" type="button">Cerrar</button>
              </div>
              <form id="expenseEditForm" class="stack">
                <input id="expenseEditId" type="hidden" />
                <label>
                  Concepto
                  <input id="expenseEditConcept" type="text" required />
                </label>
                <label>
                  Fecha
                  <input id="expenseEditDate" type="date" required />
                </label>
                <label>
                  Importe (‚Ç¨)
                  <input id="expenseEditAmount" type="number" min="0" step="0.01" required />
                </label>
                <button class="btn" type="submit">Guardar cambios</button>
              </form>
            </div>
          </div>
          <div id="expenseDeleteModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Eliminar gasto</h3>
              </div>
              <p>¬øEst√°s seguro de que quieres eliminar este gasto?</p>
              <p id="expenseDeleteInfo" class="muted"></p>
              <input id="expenseDeleteId" type="hidden" />
              <div class="btn-group">
                <button id="expenseDeleteConfirm" class="btn danger" type="button">Eliminar</button>
                <button id="expenseDeleteCancel" class="btn ghost" type="button">Cancelar</button>
              </div>
            </div>
          </div>
        </section>

        <section id="checkinsView" class="view hidden">
          <div class="card">
            <h2>Fichajes</h2>
            <div class="checkin-info stack">
              <div class="checkin-user">
                <label>Usuario</label>
                <span id="checkinUserName" class="value">-</span>
                <button id="checkinEditProfileBtn" class="btn ghost small" type="button" title="Editar perfil">‚úèÔ∏è</button>
              </div>
              <div class="checkin-datetime">
                <label>Fecha y hora</label>
                <span id="checkinDateTime" class="value">-</span>
              </div>
            </div>
            
            <!-- Profile edit section -->
            <div id="checkinProfileEdit" class="checkin-profile-edit hidden">
              <h3>Editar mi perfil</h3>
              <form id="checkinProfileForm" class="stack">
                <label>
                  Nombre
                  <input id="checkinProfileFirstName" type="text" required placeholder="Tu nombre" />
                </label>
                <label>
                  Apellidos
                  <input id="checkinProfileLastName" type="text" required placeholder="Tus apellidos" />
                </label>
                <div class="btn-group">
                  <button class="btn" type="submit">Guardar</button>
                  <button id="checkinProfileCancel" class="btn ghost" type="button">Cancelar</button>
                </div>
              </form>
            </div>
            
            <div id="checkinStatus" class="checkin-status hidden">
              <div class="checkin-active">
                <span class="status-badge open">Fichaje abierto</span>
                <div class="checkin-timer">
                  <label>Tiempo trabajado</label>
                  <span id="checkinTimer" class="timer-value">00:00:00</span>
                </div>
                <div class="checkin-times">
                  <div>
                    <label>Entrada</label>
                    <span id="checkinInTime" class="value">-</span>
                  </div>
                </div>
              </div>
            </div>
            <div id="checkinClosedStatus" class="checkin-closed-status hidden">
              <div class="checkin-closed">
                <span class="status-badge closed">Fichaje cerrado</span>
                <div class="checkin-times-closed">
                  <div>
                    <label>Entrada</label>
                    <span id="checkinClosedInTime" class="value">-</span>
                  </div>
                  <div>
                    <label>Salida</label>
                    <span id="checkinClosedOutTime" class="value">-</span>
                  </div>
                  <div>
                    <label>Tiempo trabajado</label>
                    <span id="checkinClosedDuration" class="value">-</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="checkin-actions">
              <button id="checkinOpenBtn" class="btn" type="button">Abrir fichaje</button>
              <button id="checkinCloseBtn" class="btn ghost" type="button" disabled>Cerrar fichaje</button>
            </div>
            <h3>Historial de fichajes</h3>
            <ul id="checkinList" class="list"></ul>
          </div>
          
          <!-- Admin section for OWNER role -->
          <div id="checkinAdminSection" class="card hidden">
            <div class="detail-header">
              <h2>Fichajes de trabajadores</h2>
              <div class="filter-row">
                <select id="checkinAdminMonthSelect"></select>
                <button id="checkinDownloadBtn" class="btn ghost small" type="button" title="Descargar fichajes">‚¨á Descargar</button>
              </div>
            </div>
            <div class="checkin-admin-summary">
              <div class="summary-item">
                <span class="label">Total horas mes</span>
                <span id="checkinAdminTotalHours" class="value">0h 0m</span>
              </div>
              <div class="summary-item">
                <span class="label">Fichajes</span>
                <span id="checkinAdminTotalCount" class="value">0</span>
              </div>
            </div>
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>Trabajador</th>
                    <th>Fecha</th>
                    <th>Entrada</th>
                    <th>Salida</th>
                    <th>Duraci√≥n</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="checkinAdminList"></tbody>
              </table>
            </div>
            <h3>Resumen por trabajador</h3>
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>Trabajador</th>
                    <th>Fichajes</th>
                    <th>Horas totales</th>
                    <th>Media por d√≠a</th>
                  </tr>
                </thead>
                <tbody id="checkinAdminSummaryList"></tbody>
              </table>
            </div>
          </div>
          
          <!-- Download modal -->
          <div id="checkinDownloadModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Descargar fichajes</h3>
                <button id="checkinDownloadClose" class="btn ghost small" type="button">Cerrar</button>
              </div>
              <div class="stack">
                <label>
                  Tipo de descarga
                  <select id="checkinDownloadType">
                    <option value="monthly">Mensual</option>
                    <option value="yearly">Anual</option>
                  </select>
                </label>
                <div id="checkinDownloadMonthly">
                  <label>
                    Mes
                    <select id="checkinDownloadMonth"></select>
                  </label>
                </div>
                <div id="checkinDownloadYearly" class="hidden">
                  <label>
                    A√±o
                    <select id="checkinDownloadYear"></select>
                  </label>
                </div>
                <label>
                  Trabajador (opcional)
                  <select id="checkinDownloadWorker">
                    <option value="">Todos los trabajadores</option>
                  </select>
                </label>
                <label>
                  Formato
                  <select id="checkinDownloadFormat">
                    <option value="excel">Excel (.xlsx)</option>
                    <option value="csv">CSV (.csv)</option>
                    <option value="pdf">PDF (.pdf)</option>
                  </select>
                </label>
                <button id="checkinDownloadConfirm" class="btn" type="button">Descargar</button>
              </div>
            </div>
          </div>
          
          <!-- Edit checkin modal -->
          <div id="checkinEditModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Editar fichaje</h3>
                <button id="checkinEditClose" class="btn ghost small" type="button">Cerrar</button>
              </div>
              <form id="checkinEditForm" class="stack">
                <input type="hidden" id="checkinEditId" />
                <div class="checkin-edit-info">
                  <span><strong>Trabajador:</strong> <span id="checkinEditWorker">-</span></span>
                  <span><strong>Fecha original:</strong> <span id="checkinEditOriginalDate">-</span></span>
                </div>
                <label>
                  Hora de entrada
                  <input type="datetime-local" id="checkinEditIn" required />
                </label>
                <label>
                  Hora de salida
                  <input type="datetime-local" id="checkinEditOut" />
                </label>
                <label>
                  Motivo del cambio <span class="required">*</span>
                  <textarea id="checkinEditReason" required placeholder="Explica el motivo de la modificaci√≥n..."></textarea>
                </label>
                <div class="btn-group">
                  <button class="btn" type="submit">Guardar cambios</button>
                  <button id="checkinEditCancelBtn" class="btn ghost" type="button">Cancelar</button>
                </div>
              </form>
            </div>
          </div>
          
          <!-- Checkin history modal -->
          <div id="checkinHistoryModal" class="modal hidden">
            <div class="modal-content card modal-large">
              <div class="detail-header">
                <h3>Historial de modificaciones</h3>
                <button id="checkinHistoryClose" class="btn ghost small" type="button">Cerrar</button>
              </div>
              <div class="checkin-history-info">
                <div><strong>Trabajador:</strong> <span id="checkinHistoryWorker">-</span></div>
                <div><strong>Entrada original:</strong> <span id="checkinHistoryOriginal">-</span></div>
                <div><strong>Entrada actual:</strong> <span id="checkinHistoryCurrent">-</span></div>
                <div><strong>Salida actual:</strong> <span id="checkinHistoryOut">-</span></div>
              </div>
              <div class="checkin-device-info">
                <h4>Informaci√≥n del dispositivo</h4>
                <div id="checkinHistoryDevice">-</div>
              </div>
              <h4>Modificaciones</h4>
              <div class="table-responsive">
                <table class="table">
                  <thead>
                    <tr>
                      <th>Fecha</th>
                      <th>Modificado por</th>
                      <th>Motivo</th>
                      <th>Valores anteriores</th>
                    </tr>
                  </thead>
                  <tbody id="checkinHistoryList"></tbody>
                </table>
              </div>
              <div id="checkinHistoryEmpty" class="empty-state hidden">
                <p>Este fichaje no ha sido modificado.</p>
              </div>
            </div>
          </div>
        </section>

        <section id="trainingsView" class="view hidden">
          <div class="card">
            <h2>Entrenamientos planificados</h2>
            <form id="trainingForm" class="stack">
              <label>
                T√≠tulo
                <input id="trainingTitle" type="text" required />
              </label>
              <label>
                Fecha
                <input id="trainingDate" type="date" required />
              </label>
              <label>
                Coach
                <input id="trainingCoach" type="text" />
              </label>
              <button class="btn" type="submit">Crear sesi√≥n</button>
            </form>
            <ul id="trainingList" class="list"></ul>
          </div>
        </section>

        <section id="athletesView" class="view hidden">
          <div class="card">
            <h2>Control de pagos de usuarios</h2>
            <div class="detail-header">
              <div class="table-actions">
                <button id="athleteCsvOpen" class="btn ghost small" type="button" title="Carga masiva CSV">
                  üìÑ CSV
                </button>
                <button id="athleteModalOpen" class="btn" type="button">
                  Alta de usuario
                </button>
              </div>
            </div>
          </div>
          <div id="athleteModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Alta de usuario</h3>
                <button id="athleteModalClose" class="btn ghost small" type="button">
                  Cerrar
                </button>
              </div>
              <form id="athleteForm" class="stack">
                <label>
                  Nombre
                  <input id="athleteName" type="text" list="athleteNameList" required />
                </label>
                <datalist id="athleteNameList"></datalist>
                <label>
                  Mes de pago
                  <select id="athletePaymentMonth"></select>
                </label>
                <label>
                  Tarifa
                  <select id="athleteTariff">
                    <option value="8/mes">8/mes</option>
                    <option value="12/mes">12/mes</option>
                    <option value="Ilimitado">Ilimitado</option>
                    <option value="Trimestre 8/mes">Trimestre 8/mes</option>
                    <option value="Trimestre 12/mes">Trimestre 12/mes</option>
                    <option value="Trimestre ilimitado">Trimestre ilimitado</option>
                    <option value="Semestre 8/mes">Semestre 8/mes</option>
                    <option value="Semestre 12/mes">Semestre 12/mes</option>
                    <option value="Semestre ilimitado">Semestre ilimitado</option>
                    <option value="Anual 8/mes">Anual 8/mes</option>
                    <option value="Anual 12/mes">Anual 12/mes</option>
                    <option value="Anual ilimitado">Anual ilimitado</option>
                  </select>
                </label>
                <label>
                  Precio (‚Ç¨)
                  <input id="athletePrice" type="number" min="0" step="0.01" readonly />
                </label>
                <label>
                  Pagado
                  <select id="athletePaid">
                    <option value="SI">SI</option>
                    <option value="NO">NO</option>
                  </select>
                </label>
                <button class="btn" type="submit">A√±adir atleta</button>
              </form>
            </div>
          </div>
          <div id="athleteCsvModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Carga masiva de atletas</h3>
                <button id="athleteCsvClose" class="btn ghost small" type="button">
                  Cerrar
                </button>
              </div>
              <form id="athleteCsvForm" class="stack">
                <label>
                  Archivo CSV
                  <input id="athleteCsvFile" type="file" accept=".csv,text/csv" required />
                </label>
                <label>
                  Mes de pago
                  <select id="athleteCsvMonth"></select>
                </label>
                <button class="btn" type="submit">Importar</button>
                <p id="athleteCsvStatus" class="muted"></p>
              </form>
            </div>
          </div>
          <div class="card">
            <div class="detail-header">
              <h3>Resumen mensual</h3>
              <select id="athleteMonthSelect"></select>
            </div>
            <div class="summary">
              <div>
                <p class="label">Activos</p>
                <p id="athleteSummaryActive" class="value">0</p>
              </div>
              <div>
                <p class="label">Tarifa media</p>
                <p id="athleteSummaryAverage" class="value">0 ‚Ç¨</p>
              </div>
              <div>
                <p class="label">Altas nuevas</p>
                <p id="athleteSummaryNew" class="value">0</p>
              </div>
              <div>
                <p class="label">Bajas</p>
                <p id="athleteSummaryDrop" class="value">0</p>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="detail-header athlete-list-header">
              <h3>Listado mensual</h3>
              <div class="filter-row">
                <select id="athleteListMonthSelect"></select>
                <input
                  id="athleteSearch"
                  type="search"
                  list="athleteSearchList"
                  placeholder="Buscar..."
                />
                <select id="athletePaidFilter">
                  <option value="ALL">Todos</option>
                  <option value="SI">Pagado</option>
                  <option value="NO">No pagado</option>
                </select>
              </div>
            </div>
            <datalist id="athleteSearchList"></datalist>
            <div class="table-container">
              <table class="table athlete-table-mobile">
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Tarifa</th>
                    <th>Precio</th>
                    <th>Pagado</th>
                    <th>Activo</th>
                    <th>Acci√≥n</th>
                  </tr>
                </thead>
                <tbody id="athleteList"></tbody>
              </table>
            </div>
            <p id="athleteListCount" class="muted"></p>
          </div>
        </section>

        <section id="acroView" class="view hidden">
          <div class="card">
            <h2>Control de pagos ¬∑ Atletas Acrobacias</h2>
            <div class="detail-header">
              <div class="table-actions">
                <button id="acroCsvOpen" class="btn ghost small" type="button" title="Carga masiva CSV">
                  üìÑ CSV
                </button>
                <button id="acroModalOpen" class="btn" type="button">
                  Alta de usuario
                </button>
              </div>
            </div>
          </div>
          <div id="acroModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Alta de usuario</h3>
                <button id="acroModalClose" class="btn ghost small" type="button">
                  Cerrar
                </button>
              </div>
              <form id="acroForm" class="stack">
                <label>
                  Nombre
                  <input id="acroName" type="text" list="acroNameList" required />
                </label>
                <datalist id="acroNameList"></datalist>
                <label>
                  Mes de pago
                  <select id="acroPaymentMonth"></select>
                </label>
                <label>
                  Tarifa
                  <select id="acroTariff">
                    <option value="4/mes">4/mes - 45‚Ç¨</option>
                    <option value="8/mes">8/mes - 65‚Ç¨</option>
                    <option value="12/mes">12/mes - 85‚Ç¨</option>
                    <option value="Ilimitado">Ilimitado - 105‚Ç¨</option>
                  </select>
                </label>
                <label>
                  Precio (‚Ç¨)
                  <input id="acroPrice" type="number" min="0" step="0.01" readonly />
                </label>
                <label>
                  Pagado
                  <select id="acroPaid">
                    <option value="SI">SI</option>
                    <option value="NO">NO</option>
                  </select>
                </label>
                <button class="btn" type="submit">A√±adir atleta</button>
              </form>
            </div>
          </div>
          <div id="acroCsvModal" class="modal hidden">
            <div class="modal-content card">
              <div class="detail-header">
                <h3>Carga masiva de atletas</h3>
                <button id="acroCsvClose" class="btn ghost small" type="button">
                  Cerrar
                </button>
              </div>
              <form id="acroCsvForm" class="stack">
                <label>
                  Archivo CSV
                  <input id="acroCsvFile" type="file" accept=".csv,text/csv" required />
                </label>
                <label>
                  Mes de pago
                  <select id="acroCsvMonth"></select>
                </label>
                <button class="btn" type="submit">Importar</button>
                <p id="acroCsvStatus" class="muted"></p>
              </form>
            </div>
          </div>
          <div class="card">
            <div class="detail-header">
              <h3>Resumen mensual</h3>
              <select id="acroMonthSelect"></select>
            </div>
            <div class="summary">
              <div>
                <p class="label">Activos</p>
                <p id="acroSummaryActive" class="value">0</p>
              </div>
              <div>
                <p class="label">Tarifa media</p>
                <p id="acroSummaryAverage" class="value">0 ‚Ç¨</p>
              </div>
              <div>
                <p class="label">Altas nuevas</p>
                <p id="acroSummaryNew" class="value">0</p>
              </div>
              <div>
                <p class="label">Bajas</p>
                <p id="acroSummaryDrop" class="value">0</p>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="detail-header athlete-list-header">
              <h3>Listado mensual</h3>
              <div class="filter-row">
                <select id="acroListMonthSelect"></select>
                <input
                  id="acroSearch"
                  type="search"
                  list="acroSearchList"
                  placeholder="Buscar..."
                />
                <select id="acroPaidFilter">
                  <option value="ALL">Todos</option>
                  <option value="SI">Pagado</option>
                  <option value="NO">No pagado</option>
                </select>
              </div>
            </div>
            <datalist id="acroSearchList"></datalist>
            <div class="table-container">
              <table class="table athlete-table-mobile">
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Tarifa</th>
                    <th>Precio</th>
                    <th>Pagado</th>
                    <th>Activo</th>
                    <th>Acci√≥n</th>
                  </tr>
                </thead>
                <tbody id="acroList"></tbody>
              </table>
            </div>
            <p id="acroListCount" class="muted"></p>
          </div>
        </section>



        <section id="rolesView" class="view hidden">
          <div id="rolesPanel" class="card hidden">
            <h2>Roles de usuarios (OWNER)</h2>
            <form id="createUserForm" class="stack">
              <label>
                Email
                <input id="createUserEmail" type="email" required />
              </label>
              <label>
                Contrase√±a temporal
                <input id="createUserTempPassword" type="password" required />
              </label>
              <label>
                Rol
                <select id="createUserRole">
                  <option value="OWNER">OWNER</option>
                  <option value="COACH">COACH</option>
                  <option value="RECEPTION">RECEPTION</option>
                </select>
              </label>
              <button class="btn" type="submit">Crear usuario</button>
              <p id="createUserStatus" class="muted"></p>
            </form>
            <form id="roleForm" class="stack">
              <label>
                UID del usuario
                <input id="roleUserId" type="text" required />
              </label>
              <label>
                Rol
                <select id="roleValue">
                  <option value="OWNER">OWNER</option>
                  <option value="COACH">COACH</option>
                  <option value="RECEPTION">RECEPTION</option>
                </select>
              </label>
              <button class="btn" type="submit">Actualizar rol</button>
            </form>
            <ul id="userList" class="list"></ul>
          </div>
        </section>
      </section>
    </section>

    <main class="grid">
      <section class="card" id="loginView">
        <h2>Acceso</h2>
        <form id="loginForm" class="stack">
          <label>
            Email
            <input id="loginEmail" type="email" required />
          </label>
          <label>
            Contrase√±a
            <input id="loginPassword" type="password" required />
          </label>
          <button class="btn" type="submit">Entrar</button>
          <button id="googleLoginBtn" class="btn ghost" type="button">
            Entrar con Google
          </button>
          <p class="muted">* Usuarios se gestionan en Firebase Auth.</p>
        </form>
      </section>
    </main>

    <footer class="app-footer">
      <p class="muted">OwlManage MVP ¬∑ Firebase Auth + Firestore</p>
    </footer>

    <!-- Mobile Bottom Navigation -->
    <nav id="mobileNav" class="mobile-nav hidden">
      <button class="mobile-nav-btn active" data-view="summaryView">
        <span class="icon">üìä</span>
        <span>Resumen</span>
      </button>
      <button class="mobile-nav-btn" data-view="paymentsView">
        <span class="icon">üí∞</span>
        <span>Ingresos</span>
      </button>
      <button class="mobile-nav-btn" data-view="expensesView">
        <span class="icon">üí∏</span>
        <span>Gastos</span>
      </button>
      <button class="mobile-nav-btn" data-view="athletesView">
        <span class="icon">üèãÔ∏è</span>
        <span>Atletas</span>
      </button>
      <button class="mobile-nav-btn" data-view="acroView">
        <span class="icon">ü§∏</span>
        <span>Acro</span>
      </button>
      <button class="mobile-nav-btn" data-view="moreView">
        <span class="icon">‚ò∞</span>
        <span>M√°s</span>
      </button>
    </nav>

    <!-- More menu modal for mobile -->
    <div id="moreMenu" class="modal hidden">
      <div class="modal-content card">
        <div class="detail-header">
          <h3>M√°s opciones</h3>
          <button id="moreMenuClose" class="btn ghost small" type="button">Cerrar</button>
        </div>
        <div class="stack" style="margin-top: 16px;">
          <button class="btn ghost" data-view="checkinsView" data-close-more>üìã Fichajes</button>
          <button class="btn ghost" data-view="trainingsView" data-close-more>üèÉ Entrenamientos</button>
          <button class="btn ghost" data-view="rolesView" data-close-more>üë• Roles</button>
        </div>
      </div>
    </div>

    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script type="module" src="js/main.js?v=20250219f"></script>
  </body>
</html>
